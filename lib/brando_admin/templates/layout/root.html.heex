<!DOCTYPE html>
<html lang="en">
  <head>
    <%= csrf_meta_tag() %>
    <%= live_title_tag assigns[:page_title] || "Admin", suffix: " | #{Brando.config(:app_name)}" %>
    <meta name="prefers_reduced_motion" content={@current_user.config.prefers_reduced_motion}>
    <meta name="user_id" content={@current_user.id}>
    <meta name="user_token" content={Brando.Users.build_token(@current_user.id)}>
    <script>(function(C){C.remove('no-js');C.add('js');C.add('moonwalk')})(document.documentElement.classList)</script>
    <style>html.moonwalk [data-moonwalk-run],html.moonwalk [data-moonwalk-section],html.moonwalk [data-moonwalk]{opacity:0}.fader{background-color:#fff;position:fixed;top:0;left:0;right:0;bottom:0;z-index:9998;display:none}</style>
    <%= if Brando.env() == :prod do %>
      <!-- production -->
      <script type="module" src={Brando.helpers().static_path(@conn, "/assets/admin/admin.js")} phx-track-static crossorigin defer></script>
      <link rel="modulepreload" phx-track-static href={Brando.helpers().static_path(@conn, "/assets/admin/vendor.js")}>
      <link rel="stylesheet" phx-track-static href={Brando.helpers().static_path(@conn, "/assets/admin/admin.css")}>
    <% else %>
      <!-- development -->
      <script type="module" src="http://localhost:3333/@vite/client"></script>
      <script type="module" src="http://localhost:3333/src/main.js"></script>
    <% end %>
  </head>
  <body id="app" data-env={Brando.env()}>
    <div class="fader" id="fader">
      <script>var zf = document.getElementById("fader");zf.style.display = 'block';setTimeout(function(){zf.style.display = 'none'},4000);</script>
      <div class="loading-container"></div>
    </div>
    <div class="progress-wrapper">
      <div class="progress"></div>
    </div>
    <%= render BrandoAdmin.AdminView, "_sidebar.html",
      conn: @conn,
      current_user: @current_user,
      current_url: @uri.path,
      menu_sections: BrandoAdmin.Menu.get_menu()
    %>
    <%= @inner_content %>
    <Brando.HTML.breakpoint_debug_tag />
    <Brando.HTML.grid_debug_tag />
  </body>
</html>
